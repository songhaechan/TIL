책임과 메세지
=
## 자율적인 책임

재판관이 증인에게 증언을 요청한다.

증인은 증언할 책임이 있기때문에 자신만의 방식으로 증언을 시작하게된다.

여기서 재판관은 어떻게 증언하라는 지침은 없이 단순히 증언하라는 요청만 하고있다.

증인은 증언할 책임을 갖고 적절한 응답만 해주면 될 뿐이지 어떻게 증언할 지는 온전히 자신이 결정할 일이다.

### 구체적인 요청

만약 재판관이 증인에게 좀 더 구체적인 요청을 한다고 생각해보자.

증언의 순서, 표현 방식 등등 세세한 요구사항을 다른 객체에게 요청한다면 그만큼 증인은 스스로의 자율성을 해치게된다.

### 왜 자율적이여야할까?

한 객체가 다른 객체에대해 지나치게 많이 알고있거나 행동에 지나치게 많이 관여한다는 것은 두 객체가 지나치게 연결되어있다는 말이다.

강하게 결합된 객체는 재사용하기 어렵고 확장도 어렵게 만든다. 또 가장 중요한 추상화를 할 수 없게끔 만드는 이유이기도하다.

### 너무 추상적이라면?

구체적인 요청은 좋지않다고 했다. 하지만 지나치게 추상적이라면 요청을 받은 객체는 적절한 응답을 내려주기가 힘들다.

구체적으로 어떻게 증언할지를 요청하는 것이 아니라 **무엇을** 증언할 지에대해 요청해야한다.

## 메시지와 메서드

### 메세지

한 객체가 다른 객체에게 접근할 수 있는 방법은 메세지를 보내는것 뿐이다.

이 때 필요한 것은 수신자, 수행할 행동, 부가정보 이다.

수행할 행동은 보통 메서드의 이름에 나타나있고, 부가정보는 파라미터로 생각할 수 있다.

메세지를 받은 수신자는 해당 메세지를 처리해야할 **책임**을 졌다고 할 수 있다.

하지만 이 책임은 충분히 자율적으로 수행되도록 설계해야한다.(위에서 설명)

여기서 책임은 메세지의 이름을 통해 어떤 책임을 가지고있는지 단순하게 파악해볼 수 있다.

### 다형성

객체지향의 핵심적인 개념인 다형성은 협력과 역할 책임에도 밀접한 연관이 있다.

메세지를 보내는 객체는 받는 객체가 어떤 객체인지 알 필요도 알 수도 없다.

다만 메세지받는 수신자가 적합한 응답을 할 것으로 기대할 뿐이다.

다형성은 서로 다른 타입의 수신자가 같은 메세지를 수신받지만 서로 다른 메서드를 이용해 다른 방식으로 응답한다.

사실 제일 중요한 점은 보내는 쪽에 있다.

보내는 쪽은 타입을 신경쓸 필요가 없기때문이다.

이같은 다형성의 축복 덕분에 우린 역할을 추상화할 수 있게되었다.

왜냐? 다형성은 **타입에 국한되지않고 대체 가능함**을 의미하기때문이다.

이렇게 메세지만을 통해 서로 소통하고 이 메세지마저 **수신자를 캡슐화**하는 다형성 덕분에 역할이 추상화되고 그와 동시에 협력관계역시 재사용가능한 추상화가 가능해진다.

메세지를 통한 협력관계는 자연스럽게 객체간의 결합도를 느슨하게하고 확장가능해진다.

서로가 서로를 알지 못하지만 메세지만을 수신해 응집도를 높일 수 있다는 점은 다형성이 제공하는 최고의 선물이다.

이렇게되면 자연스레 메세지의 중요성을 알 수 있을 것이다.

## 메세지를 따라라

몇 페이지에 걸친 설명의 핵심은 메세지를 신뢰하고 메세지를 중심으로 협력관계를 설계하라는 것이다.

책임 주도 설계의 What/Who 사이클을 보자.

메세지를 누구에게 보낼 것인지를 고민히자말자.

**어떤** 메세지를 보낼지부터 고민하자.

그 뒤에 누가 이 메세지에대한 책임을 가질지 생각하자.

결국은 협력이라는 문맥속에서 메세지를 생각하고 책임을 할당하는 것이다.

그리고 그 책임을 수행하는 객체는 충분히 자유롭게 메세지에대한 응답을 하는 것이다.

또 묻지말고 시켜라라는 스타일이있다.

데미테르법칙은 상태가 아닌 메세지에 초점을 맞춘다.

메세지를 믿자. 자율적 책임은 따라온다.

## 객체 인터페이스

인터페이스는 세 가지 특징이 있다.

- 인터페이스의 사용방법만 알고 있다면 내부 구조나 동작 방식은 알지 못해도 된다.

- 인터페이스가 변경되지않는다면 내부구조의 변경은 아무런 영향을 미치지않는다.

- 인터페이스만 동일하다면 어떤 대상이든 동일하게 다룰 수 있다.

## 인터페이스와 구현의 분리

- 좀 더 추상적인 인터페이스

    이 부분은 메세지와 책임에서 설명했다. 요청이 구체적일수록 객체의 자율성을 해치기에 메세지는 추상화된 형태로 보내져야한다.

- 최소 인터페이스

    외부에서 필요없는 사적인 행동은 인터페이스 뒤로 감춰야한다. 내부 구현을 최대한 감춰야 해당 객체의 변경이 외부에 미치는 영향을 최소화할 수 있다.

- 구현

    내부 구현은 최대한 숨겨져야한다. 즉 외부와 내부의 명확한 분리가 변경에대한 파급효과를 줄일 수 있다.
    이 방법은 객체가 충분히 자율적이게 만들어준다. 변경에 자유롭지 못한 객체는 절대 자유롭다고 할 수 없다.

## 책임의 자율성이 협력의 품질을 결정한다.

### 첫째

자율적인 책임은 협력을 단순하게 만든다.

앞서 메세지를 추상화하지않고 구체적으로 메세지를 구성하면 책임이 자유롭지 못하다고 했다. 자유로운 책임은 책임을 추상화하고 세부적인 것들은 무시한다.

### 둘째

내부와 외부를 명확하게 분리한다.

내부에서 어떻게 처리하는 지는 관심이 없다. 캡슐화를 통해 내부 구현을 확실히 숨기고 오직 공용인터페이스만으로 외부와 소통한다. 내부와 외부를 분리하면 수정이 발생해도 내부의 수정이 외부에 미치는 영향을 최소화할 수 있다.

### 셋째

내부를 변경하더라도 외부에 영향을 미치지않는다.

### 넷째

자율적 책임은 협력 대상을 다양하게 선택할 수 있다.

추상적인 메세지를 통해 책임을 추상화한다면 그 책임을 지는 대상까지도 추상화된다.

즉 간결한 메세지는 여러 대상을 같은 방식으로 다룰 수 있게된다.(다형성)

증언하라는 단순한 요청은 모자장수,앨리스,요리사 모두에게 메세지를 보낼 수 있지만 구체적인 메세지는 다른 타입의 객체가 응답하기 어렵게 구성될 수 있다.

### 다섯째

자율적이면 자율적일 수록 객체의 존재 이유를 명확하게 표현할 수 있다.

객체는 무엇으로 표현될까? 객체의 책임으로 표현된다.

객체의 책임은 어떤 메세지를 처리하는지로 생각할 수 있고 책임이 자유롭다는 것은 존재 이유를 명확하게 알 수 있게된다.

