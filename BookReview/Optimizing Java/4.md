성능 테스트 패턴 및 안티패턴
=

테스트는 그 유형별로 거의 독립적이다.

절대 뭉뚱그려서 테스트해서는 안된다.

결과는 정량적인 수치화된 지표로 나태내라

### 지연 테스트

지연 테스트 = 트랜잭션이 시작부터 끝까지 걸리는 시간이 걸리는가

### 처리율 테스트

처리율 테스트 = 얼마나 많은 트랜잭션을 **동시에** 수행할 수 있는가

지연과 밀접한 연관이 있다.
> 지연은 반드시 해당 테스트에서 얼마나 많은 트랜잭션이 동시에 이루어지는지를 같이 표기해야한다.

### 부하 테스트

부하 테스트는 "이정도를 서버가 견딜 수 있을까?"하는 질문에 **예/아니오**로 답을 구하는 과정이다.

> 이벤트, 광고 캠페인 등


### 스트레스 테스트

한계점을 테스트한다.

특정 처리율을 넘어가면 시스템 처리가 느려지는데 이 측정값이 나빠지기 바로 직전이 최대 처리율이다.

### 내구 테스트

보통 시간이 지나야 드러나는 문제를 테스트한다.

평균 부하를 주다가 갑자기 리소스 고갈이나 시스템이깨지는 그 지점을 찾는다.

### 용량 계획 테스트

스트레스 테스트와 비슷하지만 다르다.

스트레스 테스트는 현재 어느 정도 부하를 견딜지 테스트하고, 용량 계획 테스트는 업그레이드한 시스템이 어느 정도 부하를 감당할 수 있을지 **미리 내다본다.**

### 저하 테스트

부분 실패 테스트라고도한다.

서버가 돌아가던중 특정 컴포넌트가 죽었을 때 전체 프로세스가 능력을 상실하는 시점에 벌어지는 일을 테스트한다.

## 기본 베스트 프랙티스

성능 튜닝의 핵심은

**최적화하기 용이한 부분이 아니라 시스템에 중요한 관심사를 먼저 다룬다.**

### 하향식 성능

전체 애플리케이션의 성능 양상부터 먼저 알아보는 접근 방식

> 작은 코드 섹션별로 정확하게 측정하는 것은 하향식이 아니다.

### 테스트 환경 구축

테스트 환경은 운영환경과 최대한 비슷하게 만들어야한다.

> OS, CPU 수, 자바 버전 등

### 성능 요건 식별

성능 평가는 시스템을 전체적으로 바라봐야한다.

이를 성능 비기능 요건이라고 한다.

명확한 목표를 세워야한다.

ex)

95%의 트랜잭션을 100밀리초로 줄인다.

평균응답시간을 30% 줄인다.

### 자바의 특정 이슈

JIT컴파일러는 매우 중요한 부분이다.

JIT 컴파일러가 컴파일하지않기로 결정하는 경우는

자주 실행되지않음

너무 크고 복잡해서 컴파일 분석을 할 수 없음(드문경우)

JIT컴파일 타깃으로 만드는것은 중요하다.(중요한 메서드를!)

9장에서 자세히

