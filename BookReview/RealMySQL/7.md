데이터 암호화
=

데이터의 암호화는 디스크I/O시에만 수행된다.

버퍼풀에서 디스크로 쓰거나 디스크로부터 읽기 수행 시 암호화/복호화가 이루어진다.

이 방심을 TDE라 부른다.

### 2단계 키 관리

외부에서 제공한 **마스터 키**와 마스터키를 이용해 **테이블스페이스 키**를 만들어낸다.

테이블스페이스 키는 테이블의 헤더정보에 포함해서 저장한다.

테이블스페이스 키는 절대 외부유출이안되지만 마스터키는 외부에있기때문에 주기적으로 교체해야한다.

교체시엔 마스터키를 이용해 모든 테이블스페이스 키를 복호화하고 새로운키로 다시 암호화한 뒤 헤더에 추가한다.

이때 테이블스페이스 키 자체가 변경되는 것은 아니다.(새롭게 암호화할 뿐)

### 성능

암호화 복호화 자체가 시간이 걸리는 일이다.(짧긴하다.)

하지만 백그라운드 스레드가 수행하기때문에 사용자 쿼리가 느려지지는않는다.

일반적으로 읽기는 3~5배, 쓰기는 5~6배 차이난다.

물론 디스크로부터 I/O를 수행하는 경우에 그렇다는 것이다.

### 테이블 암호화

테이블생성 시 ENCRYPTION='Y' 로 생성하면 모든 테이블의 데이터는 암호화된다.

### 응용프로그램 암호화와 비교

응용프로그램 자체에서 암호화 뒤 MySQL서버에 넘기면 MySQL은 암호화 여부를 판단하지 못한다.

즉 암호화한 컬럼을 인덱스로 사용하면 100%로 사용이 불가능하다.

되도록이면 MySQL서버 암호화를 선택할 것을 권장한다.

하지만 TDE는 MySQL에 로그인만 할 수 있다면 평문으로 모두 확인이가능하다.

반면 응용프로그램은 로그인하더라도 확인이 불가능하다.

언두로그 리두로그 암호화
=

테이블 암호화를 적용해도 메모리에 올라온 데이터는 모두 평문이다.(버퍼풀을 말하는 것이다)

그렇기때문에 버퍼풀에서 바로 언두로그파일이나 리두로그파일엔 모두 평문으로 기록된다.

하지만 이는 시스템변수를 사용해 암호화된 상태로 저장이 가능하다.

바이너리 로그 암호화
=

파일 키(테이블스페이스 키와 동일)는 데이터를 암호화하고 파일키를 바이너리 로그 암호화 키(마스터키와 동일)로 암호화하여 파일의 헤더에 포함시킨다.